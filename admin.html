<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin – Upload MCQ Questions</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>

<body class="bg-gray-100 min-h-screen p-8">

<div class="max-w-4xl mx-auto bg-white p-8 shadow-2xl rounded-2xl">

    <h1 class="text-3xl font-bold text-center text-purple-600 mb-6">
        Admin – Upload MCQ (4-choice) Questions
    </h1>

    <p class="text-gray-600 mb-6 text-center">
        Enter <strong>10 multiple-choice questions</strong>.  
        Each question requires:  
        - Question text  
        - 4 choices  
        - Correct answer selection
    </p>

    <div id="questionForms" class="space-y-10"></div>

    <div class="text-center mt-10">
        <button onclick="uploadQuestions()"
                class="bg-purple-600 hover:bg-purple-700 text-white font-bold px-10 py-4 rounded-xl shadow-lg transition">
            Upload to Firestore
        </button>
    </div>

    <p id="statusMsg" class="text-center mt-6 text-lg font-semibold"></p>

</div>


<script>
// FIREBASE INIT
const firebaseConfig = {
    apiKey: "AIzaSyBGd_KrhvdCfxeRPcXn7f8csLUfcZkmKVs",
    authDomain: "sswt-final.firebaseapp.com",
    projectId: "sswt-final",
    storageBucket: "sswt-final.firebasestorage.app",
    messagingSenderId: "824707188580",
    appId: "1:824707188580:web:747ba4d91ab781e1a15c71"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();


// CREATE 10 QUESTION BLOCKS
function createForms() {
    const container = document.getElementById("questionForms");

    for (let i = 1; i <= 10; i++) {
        const block = document.createElement("div");
        block.className = "border rounded-xl p-6 shadow";

        block.innerHTML = `
            <h2 class="text-xl font-bold mb-4 text-purple-700">Question ${i}</h2>

            <textarea id="q${i}_text"
                      class="w-full p-3 border rounded mb-4"
                      placeholder="Enter question text..."></textarea>

            <div class="space-y-3">
                <input id="q${i}_opt1" class="w-full p-2 border rounded" placeholder="Option 1">
                <input id="q${i}_opt2" class="w-full p-2 border rounded" placeholder="Option 2">
                <input id="q${i}_opt3" class="w-full p-2 border rounded" placeholder="Option 3">
                <input id="q${i}_opt4" class="w-full p-2 border rounded" placeholder="Option 4">
            </div>

            <div class="mt-4">
                <label class="font-semibold">Correct Answer:</label>
                <select id="q${i}_answer" class="ml-2 p-2 border rounded">
                    <option value="0">Option 1</option>
                    <option value="1">Option 2</option>
                    <option value="2">Option 3</option>
                    <option value="3">Option 4</option>
                </select>
            </div>
        `;

        container.appendChild(block);
    }
}

createForms();


// UPLOAD FUNCTION
async function uploadQuestions() {
    let questionList = [];

    for (let i = 1; i <= 10; i++) {
        const text = document.getElementById(`q${i}_text`).value.trim();
        const opt1 = document.getElementById(`q${i}_opt1`).value.trim();
        const opt2 = document.getElementById(`q${i}_opt2`).value.trim();
        const opt3 = document.getElementById(`q${i}_opt3`).value.trim();
        const opt4 = document.getElementById(`q${i}_opt4`).value.trim();
        const ans = document.getElementById(`q${i}_answer`).value;

        if (!text || !opt1 || !opt2 || !opt3 || !opt4) {
            alert(`Please fill all fields for Question ${i}`);
            return;
        }

        questionList.push({
            id: "Q" + i,
            text: text,
            options: [opt1, opt2, opt3, opt4],
            answer: parseInt(ans)
        });
    }

    try {
        await db.collection("exam_questions")
                .doc("current")
                .set({
                    questions: questionList,
                    count: questionList.length
                });

        const msg = document.getElementById("statusMsg");
        msg.innerHTML = "✅ Successfully uploaded 10 MCQ questions!";
        msg.className = "text-green-600 text-center mt-6 text-lg font-semibold";

    } catch (err) {
        console.error(err);
        const msg = document.getElementById("statusMsg");
        msg.innerHTML = "❌ Upload failed. Check console.";
        msg.className = "text-red-600 text-center mt-6 text-lg font-semibold";
    }
}
</script>

</body>
</html>
